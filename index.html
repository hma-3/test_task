<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta
      name="description"
      content="Explore the Star Wars universe with this interactive table of characters. Search, filter, and discover details about their homeworlds, including climate, terrain, and population. Perfect for fans and curious explorers alike."
    />

    <title>Star Wars Characters</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
    />

    <link
      href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAABfX18AAAAAADQ0NABoaGgAPT09AElISQASEhIARkZGABsbGwBPT08Ag4ODAFhYWAAtLS0ATUxOAGFhYQA2NjYAPz8/ABQUFABISEgAHR0dACYmJgBaWloAjo6OADg4OABBQUEAHx8fAFNTUwAoKCgAXFxcADExMQBDQ0MAGBgYAExMTAAqKioAXl5eADMzMwA8PDwAERERAEVFRQBOTk4AIyMjAGBgYAA1NTUASklKABwcHABQUFAAJSUlAGtrawAVFRUAdHR0AElJSQAeHh4AJycnAGRkZABCQkIAFxcXAFdWVwApKSkAb29vAKOjowBEREQAGRkZACIiIgArKysAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBASoQFzMBAQEBAQEBAQEBATARHz09CAEBAQEBAT0lJRkhGwIEJA8GJSUfAQElJSUsHxssKDk3HyUlJQEBMyUlEz0dGS4/MzklJQEBAQElJTcMLiQkHTkRJSUBAQEBJSUZLBkPORkTCCURAQEBAQElJRMQOA02CAYlAQEBAQEBHz4mIgUrDhAzFAEBAQEBARgyCwcnIBAaCQABAQEBAQEBIzQMHRceKhUBAQEBAQEBARIyPDIQAiQVAQEBAQEBAQE6NRwDLSw+KQEBAQEBAQEBATsKFjE2LwEBAQEBAQEBAQEBAQEBAQEBAQEBAf//AAD8PwAA+B8AAIABAACAAQAAgAMAAMADAADAAwAA4AcAAOAHAADgBwAA8A8AAPAPAADwDwAA+B8AAP//AAA="
      rel="icon"
      type="image/x-icon"
    />

    <script
      src="https://kit.fontawesome.com/32c19bc39e.js"
      crossorigin="anonymous"
    ></script>
  </head>

  <body class="body">
    <main class="main container">
      <div class="search field">
        <div class="field-label is-normal has-text-left">
          <label for="search-input" class="label">Search by name</label>
        </div>

        <div class="field-body">
          <div class="field">
            <p class="control has-icons-left has-icons-right">
              <input
                class="input"
                type="text"
                id="search-input"
                placeholder="Darth Vader"
              />

              <span class="icon is-small is-left">
                <i class="fa-solid fa-magnifying-glass"></i>
              </span>

              <span class="icon is-small is-right">
                <button
                  id="clear-search-input"
                  class="delete is-hidden"
                ></button>
              </span>
            </p>
          </div>
        </div>
      </div>

      <table class="c-table table is-striped is-fullwidth is-hoverable">
        <thead>
          <tr>
            <th>Character Name</th>
            <th>Gender</th>
            <th>Birth Year</th>
            <th>Home World</th>
          </tr>
        </thead>
        <tbody class="c-tbody table-group-divider"></tbody>
      </table>

      <div class="not-found is-hidden">
        <p class="subtitle has-text-primary mb-0 has-text-weight-semibold">
          No results found
        </p>
        <button id="clear-search-button" class="button">Clear search</button>
      </div>

      <div class="modal">
        <div class="modal-background"></div>

        <div class="modal-card">
          <header class="modal-card-head">
            <h2 class="hw-name modal-card-title has-text-weight-semibold"></h2>
            <button id="close-modal" class="delete" aria-label="close"></button>
          </header>

          <section class="modal-card-body">
            <table class="hw-table table is-fullwidth">
              <tbody>
                <tr>
                  <th scope="row">Climate</th>
                  <td class="hw-climate"></td>
                </tr>

                <tr>
                  <th scope="row">Terrain</th>
                  <td class="hw-terrain"></td>
                </tr>

                <tr>
                  <th scope="row">Population</th>
                  <td class="hw-population"></td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </div>
    </main>

    <footer
      class="footer pb-6 is-size-3 has-text-primary has-text-weight-semibold"
    >
      <p class="footer__content">
        Star Wars Characters Table
        <br />
        Made by
        <a
          href="https://github.com/hma-3"
          target="_blank"
          class="has-text-primary"
          >Mariia Hula</a
        >
      </p>
    </footer>

    <script>
      const tBody = document.querySelector(".c-tbody");
      const searchInput = document.getElementById("search-input");
      const clearSearchInput = document.getElementById("clear-search-input");
      const clearSearchButton = document.getElementById("clear-search-button");
      const notFound = document.querySelector(".not-found");

      loadCharactersData();

      searchInput.addEventListener("input", debounce(changeSearch));

      [clearSearchInput, clearSearchButton].forEach((item) =>
        item.addEventListener("click", () => {
          searchInput.value = "";
          filterTable("");
          clearSearchInput.classList.add("is-hidden");
        })
      );

      function loadCharactersData() {
        fetch("https://swapi.info/api/people")
          .then((res) => {
            if (!res.ok) {
              throw new Error(`HTTP error! status: ${res.status}`);
            }
            return res.json();
          })
          .then((data) => {
            addDataToTable(tBody, data.slice(0, 5));
          })
          .catch(() => console.warn(error));
      }

      function loadHomeWorldData(url) {
        fetch(url)
          .then((res) => {
            if (!res.ok) {
              throw new Error(`HTTP error! status: ${res.status}`);
            }
            return res.json();
          })
          .then((data) => {
            createHomeWorldModal(data);
          })
          .catch((error) => console.warn(error));
      }

      function addDataToTable(table, data) {
        data.map((item) => {
          const row = document.createElement("tr");
          const nameCell = document.createElement("td");
          const genderCell = document.createElement("td");
          const birthYearCell = document.createElement("td");
          const homeWorldCell = document.createElement("td");

          nameCell.innerText = item.name;
          nameCell.classList.add("c-name");
          genderCell.innerText = item.gender;
          birthYearCell.innerText = item.birth_year;
          homeWorldCell.appendChild(createHomeWorldButton(item.homeworld));

          row.appendChild(nameCell);
          row.appendChild(genderCell);
          row.appendChild(birthYearCell);
          row.appendChild(homeWorldCell);

          table.appendChild(row);
        });
      }

      function createHomeWorldButton(url) {
        const homeWorldButton = document.createElement("button");
        const modal = document.querySelector(".modal");

        homeWorldButton.className = "button";
        homeWorldButton.innerText = "Show info";
        homeWorldButton.addEventListener("click", () => {
          loadHomeWorldData(url);
        });

        return homeWorldButton;
      }

      function createHomeWorldModal(data) {
        const modal = document.querySelector(".modal");
        const modalBackground = document.querySelector(".modal-background");
        const name = document.querySelector(".hw-name");
        const climate = document.querySelector(".hw-climate");
        const terrain = document.querySelector(".hw-terrain");
        const population = document.querySelector(".hw-population");
        const modalClose = document.getElementById("close-modal");

        [modalClose, modalBackground].forEach((item) =>
          item.addEventListener("click", () =>
            modal.classList.remove("is-active")
          )
        );

        name.innerText = data.name;
        climate.innerText = data.climate;
        terrain.innerText = data.terrain;
        population.innerText = splitLargeNum(data.population);

        modal.classList.add("is-active");
      }

      function changeSearch(event) {
        if (event.target.value) {
          clearSearchInput.classList.remove("is-hidden");
        } else {
          clearSearchInput.classList.add("is-hidden");
        }

        const filterText = event.target.value.toLowerCase().trim();
        filterTable(filterText);
      }

      function filterTable(searchQuery) {
        tBody.classList.remove("is-hidden");
        notFound.classList.add("is-hidden");

        const rows = document.querySelectorAll(".c-tbody tr");
        let countVisible = 0;

        rows.forEach((row) => {
          const nameCell = row.querySelector(".c-name");

          if (nameCell) {
            const nameText = nameCell.innerText.toLowerCase();

            if (nameText.includes(searchQuery)) {
              row.classList.remove("is-hidden");
              countVisible++;
            } else {
              row.classList.add("is-hidden");
            }
          }
        });

        if (!countVisible) {
          tBody.classList.add("is-hidden");
          notFound.classList.remove("is-hidden");
        }
      }

      function debounce(func, timeout = 300) {
        let timer;
        return (...args) => {
          clearTimeout(timer);
          timer = setTimeout(() => {
            func.apply(this, args);
          }, timeout);
        };
      }

      function splitLargeNum(num) {
        return Number(num).toLocaleString("en-US");
      }
    </script>
  </body>
</html>

<style>
  :root {
    --bulma-primary-h: 53deg;
    --bulma-primary-s: 96%;
    --bulma-primary-l: 56%;
    --bulma-link-h: 246deg;
    --bulma-link-s: 31%;
    --bulma-link-l: 48%;

    --tablet: 640px;
    --desktop: 1200px;

    overflow-y: auto;
  }

  .body {
    min-height: 100vh;
    display: grid;
    grid-template-rows: 1fr auto;
  }

  .main {
    padding: 24px 16px;

    @media (min-width: var(--tablet)) {
      padding: 32px 24px;
    }

    @media (min-width: var(--desktop)) {
      padding: 56px 32px;
    }
  }

  .not-found {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
  }

  .footer {
    perspective: 200px;
  }

  .footer__content {
    width: 100%;

    text-align: center;

    transform: rotateX(30deg);
  }
</style>
